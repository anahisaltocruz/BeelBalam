CREATE DATABASE BEEL_BALAM;
USE BEEL_BALAM;

CREATE TABLE TARJETA(
	CVC INT NOT NULL,
	PRIMER_NOMBRE_T VARCHAR (15) NOT NULL,
	SEGUNDO_NOMBRE_T VARCHAR (15),
	PRIMER_APELLIDO_T VARCHAR (15) NOT NULL,
	SEGUNDO_APELLIDO_T VARCHAR (15),
	FECHA_VIGENCIA INT NOT NULL,
	NUM_TARJETA VARCHAR(17),

	PRIMARY KEY(NUM_TARJETA)
);

CREATE TABLE CLIENTE(
	ID_CLIENTE INT NOT NULL,
	PRIMER_NOMBRE_C VARCHAR (15) NOT NULL,
	SEGUNDO_NOMBRE_C VARCHAR (15),
	PRIMER_APELLIDO_C VARCHAR (15) NOT NULL,
	SEGUNDO_APELLIDO_C VARCHAR (15),
	EDAD_C INT NOT NULL,
	NACIONALIDAD_C VARCHAR(25) NOT NULL,

	PRIMARY KEY(ID_CLIENTE)
);

CREATE TABLE USUARIO(
	NOMBRE_U VARCHAR(25) NOT NULL,
	CONTRASENIA_U VARCHAR(20) NOT NULL,
	CORREO_U VARCHAR(35) NOT NULL,
	NUM_CEL_U VARCHAR(14) NOT NULL,
	PTOS_ACUM_U INT NOT NULL,
	NUM_TARJETA_U VARCHAR (17) NOT NULL

	PRIMARY KEY(NOMBRE_U),
	FOREIGN KEY (NUM_TARJETA_U) REFERENCES TARJETA (NUM_TARJETA)
);

CREATE TABLE TRAMO(
	NOMBRE_TR VARCHAR(25) NOT NULL,
	EST_F VARCHAR(25) NOT NULL,
	EST_I VARCHAR(25) NOT NULL,
	COLOR_TR VARCHAR(25) NOT NULL,
	COSTO_TR INT NOT NULL,

	PRIMARY KEY(NOMBRE_TR)
);

CREATE TABLE ESTACIONES(
	NOMBRE_EST VARCHAR(25) NOT NULL,
	NOMBRE_TR VARCHAR(25) NOT NULL,

	PRIMARY KEY(NOMBRE_EST),
	FOREIGN KEY (NOMBRE_TR) REFERENCES TRAMO (NOMBRE_TR)
);

CREATE TABLE TREN(
	MAT_TREN VARCHAR(25) NOT NULL,
	CAPACIDAD INT NOT NULL,

	PRIMARY KEY(MAT_TREN)
);

CREATE TABLE ASIENTO(
	NUM_A INT NOT NULL,
	MAT_TREN VARCHAR(25) NOT NULL,

	PRIMARY KEY(NUM_A),
	FOREIGN KEY (MAT_TREN) REFERENCES TREN (MAT_TREN)
);

CREATE TABLE RESERVA(
	COD_R INT NOT NULL,
	FECHA_R DATETIME NOT NULL,
	NOMBRE_U VARCHAR(25) NOT NULL,
	NOMBRE_TR VARCHAR(25) NOT NULL,
	ID_CLIENTE INT NOT NULL,
	NUM_A INT NOT NULL,

	PRIMARY KEY(COD_R),
	FOREIGN KEY (NOMBRE_U) REFERENCES USUARIO (NOMBRE_U),
	FOREIGN KEY (NOMBRE_TR) REFERENCES TRAMO (NOMBRE_TR),
	FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE (ID_CLIENTE),
	FOREIGN KEY (NUM_A) REFERENCES ASIENTO (NUM_A),
);

ALTER TABLE RESERVA
	ADD COSTO_R FLOAT;

INSERT INTO TARJETA (NUM_TARJETA,CVC,FECHA_VIGENCIA,PRIMER_NOMBRE_T,SEGUNDO_NOMBRE_T,PRIMER_APELLIDO_T,SEGUNDO_APELLIDO_T)
	VALUES (1234567890123456,123,1220,'ITZEL','BERENICE','CABRERA','VAZQUEZ');
INSERT INTO TARJETA (NUM_TARJETA,CVC,FECHA_VIGENCIA,PRIMER_NOMBRE_T,SEGUNDO_NOMBRE_T,PRIMER_APELLIDO_T,SEGUNDO_APELLIDO_T)
	VALUES (6734567890123456,132,1223,'ADAL',NULL,'CABRERA','VAZQUEZ');
INSERT INTO TARJETA (NUM_TARJETA,CVC,FECHA_VIGENCIA,PRIMER_NOMBRE_T,SEGUNDO_NOMBRE_T,PRIMER_APELLIDO_T,SEGUNDO_APELLIDO_T)
	VALUES (1134567890123456,432,1221,'ANAHÍ',NULL,'SALTO','CRUZ');
INSERT INTO TARJETA (NUM_TARJETA,CVC,FECHA_VIGENCIA,PRIMER_NOMBRE_T,SEGUNDO_NOMBRE_T,PRIMER_APELLIDO_T,SEGUNDO_APELLIDO_T)
	VALUES (2234567890123456,776,1020,'JOSE','ANTONIO','RODRIGUEZ','MARQUEZ');
INSERT INTO TARJETA (NUM_TARJETA,CVC,FECHA_VIGENCIA,PRIMER_NOMBRE_T,SEGUNDO_NOMBRE_T,PRIMER_APELLIDO_T,SEGUNDO_APELLIDO_T)
	VALUES (3434567890123456,983,1221,'ADAL','ALFREDO','TORRES','HINOJOSA');

INSERT INTO USUARIO(NOMBRE_U,CONTRASENIA_U,NUM_CEL_U,CORREO_U,PTOS_ACUM_U,NUM_TARJETA_U)
	VALUES ('itzeeelcava',1234567,9981007898,'itzel@gmail',0,1234567890123456);
INSERT INTO USUARIO(NOMBRE_U,CONTRASENIA_U,NUM_CEL_U,CORREO_U,PTOS_ACUM_U,NUM_TARJETA_U)
	VALUES ('anahisc',125677,9981004598,'anahi@gmail',0,1134567890123456);
INSERT INTO USUARIO(NOMBRE_U,CONTRASENIA_U,NUM_CEL_U,CORREO_U,PTOS_ACUM_U,NUM_TARJETA_U)
	VALUES ('joserm',125347,9986504598,'jrm@gmail',0,2234567890123456);
INSERT INTO USUARIO(NOMBRE_U,CONTRASENIA_U,NUM_CEL_U,CORREO_U,PTOS_ACUM_U,NUM_TARJETA_U)
	VALUES ('joseath',785677,9909004598,'jath@gmail',0,3434567890123456);
INSERT INTO USUARIO(NOMBRE_U,CONTRASENIA_U,NUM_CEL_U,CORREO_U,PTOS_ACUM_U,NUM_TARJETA_U)
	VALUES ('adalcv',129877,9980204598,'adalcv@gmail',0,6734567890123456);

INSERT INTO TRAMO(NOMBRE_TR,EST_F,EST_I,COLOR_TR,COSTO_TR)
	VALUES ('TS1','ESCARCEGA','PALENQUE','NEGRO',700);
INSERT INTO TRAMO(NOMBRE_TR,EST_F,EST_I,COLOR_TR,COSTO_TR)
	VALUES ('TG1-2','IZAMAL','ESCARCEGA','ROSA',500);
INSERT INTO TRAMO(NOMBRE_TR,EST_F,EST_I,COLOR_TR,COSTO_TR)
	VALUES ('TG3','TULUM','IZAMAL','VERDE',1500);
INSERT INTO TRAMO(NOMBRE_TR,EST_F,EST_I,COLOR_TR,COSTO_TR)
	VALUES ('TC1','BACALAR','TULUM','MARRON',700);
INSERT INTO TRAMO(NOMBRE_TR,EST_F,EST_I,COLOR_TR,COSTO_TR)
	VALUES ('TC2','TULUM','CANCUN','CAFE',1500);
INSERT INTO TRAMO(NOMBRE_TR,EST_F,EST_I,COLOR_TR,COSTO_TR)
	VALUES ('TS2','BACALAR','ESCARCEGA','ORO',1200);

INSERT INTO ESTACIONES(NOMBRE_EST,NOMBRE_TR)
	VALUES ('BACALAR','TS2');
INSERT INTO ESTACIONES(NOMBRE_EST,NOMBRE_TR)
	VALUES ('TULUM','TG3');
INSERT INTO ESTACIONES(NOMBRE_EST,NOMBRE_TR)
	VALUES ('ESCARCEGA','TG1-2');
INSERT INTO ESTACIONES(NOMBRE_EST,NOMBRE_TR)
	VALUES ('PALENQUE','TS1');
INSERT INTO ESTACIONES(NOMBRE_EST,NOMBRE_TR)
	VALUES ('IZAMAL','TG1-2');

INSERT INTO CLIENTE(ID_CLIENTE,PRIMER_NOMBRE_C,SEGUNDO_NOMBRE_C,PRIMER_APELLIDO_C,SEGUNDO_APELLIDO_C,EDAD_C,NACIONALIDAD_C)
	VALUES (500,'ITZEL','BERENICE','CABRERA','VAZQUEZ',19,'MEXICANA');
INSERT INTO CLIENTE(ID_CLIENTE,PRIMER_NOMBRE_C,SEGUNDO_NOMBRE_C,PRIMER_APELLIDO_C,SEGUNDO_APELLIDO_C,EDAD_C,NACIONALIDAD_C)
	VALUES (501,'ANAHI',NULL,'SALTO','CRUZ',20,'MEXICANA');
INSERT INTO CLIENTE(ID_CLIENTE,PRIMER_NOMBRE_C,SEGUNDO_NOMBRE_C,PRIMER_APELLIDO_C,SEGUNDO_APELLIDO_C,EDAD_C,NACIONALIDAD_C)
	VALUES (502,'MICHAEL',NULL,'PHELPS',NULL,35,'MEXICANA');
INSERT INTO CLIENTE(ID_CLIENTE,PRIMER_NOMBRE_C,SEGUNDO_NOMBRE_C,PRIMER_APELLIDO_C,SEGUNDO_APELLIDO_C,EDAD_C,NACIONALIDAD_C)
	VALUES (503,'JOSE','ANTONIO','RODRIGUEZ','MARQUEZ',5,'MEXICANA');
INSERT INTO CLIENTE(ID_CLIENTE,PRIMER_NOMBRE_C,SEGUNDO_NOMBRE_C,PRIMER_APELLIDO_C,SEGUNDO_APELLIDO_C,EDAD_C,NACIONALIDAD_C)
	VALUES (504,'ABRIL','CASSANDRA','CABRERA','VAZQUEZ',29,'BRASIL');

INSERT INTO TREN(MAT_TREN,CAPACIDAD)
	VALUES ('456FHS',40);
INSERT INTO TREN(MAT_TREN,CAPACIDAD)
	VALUES ('436RFS',40);
INSERT INTO TREN(MAT_TREN,CAPACIDAD)
	VALUES ('124OLS',40);
INSERT INTO TREN(MAT_TREN,CAPACIDAD)
	VALUES ('945OME',40);
INSERT INTO TREN(MAT_TREN,CAPACIDAD)
	VALUES ('975IER',40);

INSERT INTO ASIENTO(NUM_A,MAT_TREN)
	VALUES (1,'975IER');
INSERT INTO ASIENTO(NUM_A,MAT_TREN)
	VALUES (2,'124OLS');
INSERT INTO ASIENTO(NUM_A,MAT_TREN)
	VALUES (3,'436RFS');
INSERT INTO ASIENTO(NUM_A,MAT_TREN)
	VALUES (4,'456FHS');
INSERT INTO ASIENTO(NUM_A,MAT_TREN)
	VALUES (5,'975IER');

INSERT INTO RESERVA(COD_R,FECHA_R,NOMBRE_U,NOMBRE_TR,ID_CLIENTE,NUM_A,COSTO_R)
	VALUES (09876,'12/10/21','itzeeelcava','TS1',500,2,700);
INSERT INTO RESERVA(COD_R,FECHA_R,NOMBRE_U,NOMBRE_TR,ID_CLIENTE,NUM_A,COSTO_R)
	VALUES (06476,'10/01/20','adalcv','TC1',504,4,700);
INSERT INTO RESERVA(COD_R,FECHA_R,NOMBRE_U,NOMBRE_TR,ID_CLIENTE,NUM_A,COSTO_R)
	VALUES (23876,'12/10/21','anahisc','TC2',501,5,1500);
INSERT INTO RESERVA(COD_R,FECHA_R,NOMBRE_U,NOMBRE_TR,ID_CLIENTE,NUM_A,COSTO_R)
	VALUES (85876,'12/03/21','joseath','TS1',503,3,700);
INSERT INTO RESERVA(COD_R,FECHA_R,NOMBRE_U,NOMBRE_TR,ID_CLIENTE,NUM_A,COSTO_R)
	VALUES (98876,'22/04/21','itzeeelcava','TG3',502,3,1500);

DELETE FROM RESERVA WHERE NOMBRE_U = 'adalcv'
DELETE FROM RESERVA WHERE NOMBRE_U = 'joseath'

DELETE FROM USUARIO WHERE NOMBRE_U = 'adalcv'
DELETE FROM USUARIO WHERE NOMBRE_U = 'joseath'

DELETE FROM TARJETA WHERE NUM_TARJETA IN ('3434567890123456','6734567890123456')

DELETE FROM ESTACIONES WHERE NOMBRE_EST IN ('BACALAR','TULUM')

DELETE FROM CLIENTE WHERE ID_CLIENTE >502

DELETE FROM ASIENTO WHERE NUM_A IN (1,4)

DELETE FROM TREN WHERE MAT_TREN IN ('945OME','456FHS')

DELETE FROM TRAMO WHERE NOMBRE_TR = 'TC1'
DELETE FROM TRAMO WHERE NOMBRE_TR = 'TS2'

UPDATE RESERVA SET FECHA_R = '12/12/21' WHERE COD_R = 9876
UPDATE RESERVA SET FECHA_R = '01/05/21' WHERE COD_R = 23876
UPDATE RESERVA SET FECHA_R = '14/02/22' WHERE COD_R = 98876

UPDATE USUARIO SET CONTRASENIA_U = '0987653' WHERE NOMBRE_U = 'anahisc'
UPDATE USUARIO SET NUM_CEL_U = '55897894' WHERE NOMBRE_U = 'anahisc'
UPDATE USUARIO SET PTOS_ACUM_U = 100 WHERE NOMBRE_U = 'anahisc'

UPDATE TARJETA SET FECHA_VIGENCIA = '0123' WHERE NUM_TARJETA = '1134567890123456'
UPDATE TARJETA SET PRIMER_NOMBRE_T = 'BERENICE' WHERE NUM_TARJETA = '1234567890123456'
UPDATE TARJETA SET CVC = '987' WHERE NUM_TARJETA = '1134567890123456'

UPDATE ESTACIONES SET NOMBRE_TR = 'TS1' WHERE NOMBRE_EST = 'ESCARCEGA'
UPDATE ESTACIONES SET NOMBRE_TR = 'TG3' WHERE NOMBRE_EST = 'IZAMAL'
UPDATE ESTACIONES SET NOMBRE_TR = 'TC2' WHERE NOMBRE_EST = 'PALENQUE'

UPDATE CLIENTE SET NACIONALIDAD_C = 'ESTADOUNIDENSE' WHERE ID_CLIENTE = 502
UPDATE CLIENTE SET EDAD_C = 25 WHERE ID_CLIENTE = 500
UPDATE CLIENTE SET NACIONALIDAD_C = 'HOLANDESA' WHERE ID_CLIENTE = 501

UPDATE ASIENTO SET MAT_TREN = '436RFS' WHERE NUM_A = 2
UPDATE ASIENTO SET MAT_TREN = '436RFS' WHERE NUM_A = 3
UPDATE ASIENTO SET MAT_TREN = '124OLS' WHERE NUM_A = 5

UPDATE TREN SET CAPACIDAD = 35 WHERE MAT_TREN = '124OLS'
UPDATE TREN SET CAPACIDAD = 50 WHERE MAT_TREN = '436RFS'
UPDATE TREN SET CAPACIDAD = 43 WHERE MAT_TREN = '975IER'

UPDATE TRAMO SET COLOR_TR = 'ORO' WHERE NOMBRE_TR = 'TC2'
UPDATE TRAMO SET COSTO_TR = 2000 WHERE NOMBRE_TR = 'TG3'
UPDATE TRAMO SET EST_F = 'IZAMAL' WHERE NOMBRE_TR = 'TS1'

SELECT *FROM RESERVA
SELECT *FROM TRAMO